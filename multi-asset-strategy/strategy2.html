<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì „ëµ ì—°êµ¬ â€” íƒ€ì„ë¨¸ì‹  & í¬íŠ¸í´ë¦¬ì˜¤</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://kittycapital.github.io/strategy-lab/data.js"></script>
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.1/kakao.min.js" crossorigin="anonymous" async></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg0:#000;--bg1:#07070d;--bg2:#0d0d16;--bg3:#13131f;--bg4:#1a1a2a;
  --bdr:#1a1a2e;--bdr2:#282845;
  --t1:#e8e8f0;--t2:#b0b0c8;--t3:#8888a0;--t4:#686880;
  --g:#00ff88;--gd:#00cc6a;--r:#ff4466;--b:#4488ff;--y:#ffcc00;--p:#aa66ff;--c:#00ccee;--o:#ff8844;
}
body{background:var(--bg0);color:var(--t1);font-family:'Noto Sans KR',system-ui,sans-serif;overflow-x:hidden}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:var(--bg1)}::-webkit-scrollbar-thumb{background:var(--bdr2);border-radius:3px}
a{color:var(--g);text-decoration:none}
.hdr{padding:12px 28px;border-bottom:1px solid var(--bdr);display:flex;align-items:center;justify-content:center;background:var(--bg1);flex-wrap:wrap;gap:12px}
.hdr-title{font-weight:700;font-size:15px;color:#fff;margin-right:16px}
.tabs{display:flex;gap:3px;background:var(--bg2);border-radius:9px;padding:3px;border:1px solid var(--bdr)}
.tab{padding:7px 16px;border-radius:7px;cursor:pointer;font-size:12px;font-weight:500;color:var(--t2);border:none;background:none;white-space:nowrap;transition:.15s;font-family:inherit}
.tab:hover{color:var(--t1);background:var(--bg3)}
.tab.on{background:var(--g);color:#000;font-weight:700}
.nav-link{padding:7px 14px;border-radius:7px;font-size:12px;font-weight:600;color:var(--t3);background:var(--bg2);border:1px solid var(--bdr);display:inline-flex;align-items:center;gap:5px;text-decoration:none;transition:.15s;white-space:nowrap;cursor:pointer}
.nav-link:hover{color:var(--t1);border-color:var(--bdr2);background:var(--bg3)}
.main{padding:20px 28px;max-width:1400px;margin:0 auto}
.stitle{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--t4);margin:14px 0 8px}.stitle:first-child{margin-top:0}
.prow{display:flex;gap:5px;flex-wrap:wrap}
.pbtn{padding:5px 11px;border:1px solid var(--bdr);border-radius:5px;cursor:pointer;font-size:10px;font-family:'JetBrains Mono',monospace;font-weight:500;background:var(--bg1);color:var(--t3);transition:.12s}
.pbtn:hover{border-color:var(--bdr2)}.pbtn.on{border-color:var(--g);background:rgba(0,255,136,.07);color:var(--g)}
.loading{display:flex;align-items:center;justify-content:center;height:300px;flex-direction:column;gap:10px}
.spinner{width:36px;height:36px;border:3px solid var(--bdr);border-top-color:var(--g);border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.scard{background:var(--bg1);border:1px solid var(--bdr);border-radius:7px;padding:12px}
.scard .sl{font-size:10px;color:var(--t4);margin-bottom:3px;letter-spacing:.5px;font-weight:600}
.scard .sv{font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:700}
.scard .sv.pos{color:var(--g)}.scard .sv.neg{color:var(--r)}
.scard .ss{font-size:9px;color:var(--t4);margin-top:2px;font-family:'JetBrains Mono',monospace}
table.ct{width:100%;border-collapse:collapse;font-size:11px}
.ct th{text-align:left;padding:8px 10px;border-bottom:1px solid var(--bdr2);font-size:9px;letter-spacing:.5px;color:var(--t4);font-weight:700}
.ct td{padding:8px 10px;border-bottom:1px solid var(--bdr);font-family:'JetBrains Mono',monospace;font-size:11px}
.ct tr:hover td{background:var(--bg3)}
.chart-wrap{width:100%;margin-bottom:20px;position:relative}
.tm-hero{text-align:center;padding:32px 16px 24px}
.tm-hero h2{font-size:28px;font-weight:800;background:linear-gradient(135deg,var(--g),var(--c),var(--p));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:6px}
.tm-hero p{color:var(--t2);font-size:13px;max-width:460px;margin:0 auto}
.tm-ctrls{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin:20px 0}
.tm-ctrl{background:var(--bg2);border:1px solid var(--bdr);border-radius:9px;padding:14px 16px;min-width:180px}
.tm-ctrl label{font-size:10px;color:var(--t4);letter-spacing:.5px;display:block;margin-bottom:6px;font-weight:700}
.tm-ctrl select,.tm-ctrl input{width:100%;padding:9px 10px;background:var(--bg1);border:1px solid var(--bdr);border-radius:5px;color:var(--t1);font-size:13px;font-family:'JetBrains Mono',monospace;font-weight:600}
.tm-ctrl input:focus{outline:none;border-color:var(--g)}
select:focus{outline:none;border-color:var(--g)}
.tm-run{padding:12px 40px;background:linear-gradient(135deg,var(--g),var(--c));border:none;border-radius:9px;font-size:14px;font-weight:700;color:#000;cursor:pointer;margin:16px auto;display:block;font-family:inherit;transition:.3s}
.tm-run:hover{transform:scale(1.04);box-shadow:0 0 24px rgba(0,255,136,.3)}
.podium{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:20px;max-width:860px;margin-left:auto;margin-right:auto}
.pod{background:var(--bg2);border:1px solid var(--bdr);border-radius:11px;padding:18px;text-align:center;position:relative;overflow:hidden}
.pod.g{border-color:var(--y)}.pod.g::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,transparent,var(--y),transparent)}
.pod.s{border-color:var(--t4)}.pod.b{border-color:var(--o)}
.pod .rk{font-size:26px;font-weight:800;margin-bottom:3px}
.pod .pa{font-size:13px;font-weight:700;margin-bottom:2px}.pod .ps{font-size:10px;color:var(--t4);margin-bottom:7px}
.pod .pv{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:700;color:var(--g)}
.pod .pr{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--t2);margin-top:3px}
.helpbox{background:var(--bg2);border:1px solid var(--bdr);border-radius:10px;margin-bottom:20px;overflow:hidden}
.helpbtn{width:100%;padding:10px 16px;background:none;border:none;color:var(--t2);font-size:12px;font-family:inherit;cursor:pointer;display:flex;align-items:center;gap:6px;transition:.15s}
.helpbtn:hover{color:var(--t1);background:var(--bg3)}
.helpbtn .arrow{transition:transform .2s;font-size:10px}
.helpbtn .arrow.open{transform:rotate(90deg)}
.helpcontent{padding:0 16px 14px;font-size:12px;color:var(--t2);line-height:1.8}
.helpcontent b{color:var(--t1);font-weight:600}
.helpcontent .hitem{margin-bottom:8px}
.helpcontent .tag{display:inline-block;background:rgba(0,255,136,.08);color:var(--g);padding:1px 6px;border-radius:4px;font-size:10px;font-weight:600;margin-right:4px;font-family:'JetBrains Mono',monospace}
.glossary{margin-top:10px;padding-top:10px;border-top:1px solid var(--bdr)}
.glossary .gi{display:flex;gap:8px;margin-bottom:6px;font-size:11px}
.glossary .gi .gt{color:var(--g);font-weight:700;min-width:44px;font-family:'JetBrains Mono',monospace;font-size:10px}
.glossary .gi .gd{color:var(--t3)}
.pfgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;max-width:1100px;margin:0 auto}
.pfcard{background:var(--bg2);border:1px solid var(--bdr);border-radius:11px;padding:20px}
.pfcard h3{font-size:15px;font-weight:700;margin-bottom:3px}.pfcard .dd{font-size:11px;color:var(--t2);margin-bottom:14px}
.abar{display:flex;height:22px;border-radius:3px;overflow:hidden;margin-bottom:10px}
.abar>div{transition:width .3s}
.alist{font-size:10px}
.aitm{display:flex;justify-content:space-between;align-items:center;padding:3px 0;border-bottom:1px solid var(--bdr)}
.aitm .dot{width:7px;height:7px;border-radius:50%;margin-right:6px;display:inline-block}
.share-bar{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-top:1px solid var(--bdr);background:var(--bg1);border-radius:0 0 11px 11px;margin-top:20px}
.share-bar-preview{font-size:11px;color:var(--t3);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:50%;font-family:'JetBrains Mono',monospace}
.share-bar-preview b{color:var(--t2);font-weight:600}
.share-bar-buttons{display:flex;align-items:center;gap:6px;flex-shrink:0}
.share-btn{display:inline-flex;align-items:center;gap:6px;padding:7px 14px;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;transition:all .15s;border:1px solid var(--bdr2);background:var(--bg2);color:var(--t3);white-space:nowrap;font-family:inherit}
.share-btn:hover{transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.3);color:var(--t1)}
.share-btn svg{flex-shrink:0}
.share-btn--x:hover{border-color:#fff;color:#fff;background:var(--bg3)}
.share-btn--kakao:hover{border-color:#FEE500;color:#191919;background:#FEE500}
.share-btn--tg:hover{border-color:#26A5E4;color:#fff;background:rgba(38,165,228,.15)}
.share-btn--ig:hover{border-color:#E4405F;color:#fff;background:rgba(228,64,95,.15)}
.share-btn--copy:hover{border-color:var(--g);color:var(--g);background:rgba(0,255,136,.07)}
@media(max-width:900px){.podium{grid-template-columns:1fr}.pfgrid{grid-template-columns:1fr}.hdr{padding:12px 16px}.main{padding:12px 16px}}
@media(max-width:640px){
.hdr{flex-wrap:wrap;gap:6px;padding:10px 12px}
.hdr-title{font-size:13px;margin-right:8px}
.tab{font-size:11px;padding:5px 8px}
.nav-link{font-size:10px;padding:5px 10px}
.main{padding:10px 10px}
table.ct{font-size:9px;display:block;overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}
table.ct th,table.ct td{padding:6px 5px}
.podium{gap:8px}
.helpbtn{font-size:11px;padding:8px 12px}
.helpcontent{padding:10px 12px}
.glossary .gi .gt{min-width:36px;font-size:9px}
.glossary .gi .gd{font-size:10px}
.tm-ctrl{min-width:140px;padding:10px 12px}
.tm-ctrl select,.tm-ctrl input{font-size:12px;padding:7px 8px}
.share-bar{flex-direction:column;gap:10px;align-items:stretch}
.share-bar-preview{max-width:100%}
.share-bar-buttons{justify-content:center;flex-wrap:wrap}
.share-btn .lbl{display:none}
.share-btn{padding:8px 10px}
}
@keyframes toastIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<div id="root"></div>
<script>
/* ===== Share System ===== */
var SHARE_URL = 'https://herdvibe.com/49';
var KAKAO_KEY = 'a43ed7b39fac35458f4f9df925a279b5';
var OG_IMAGE = 'https://raw.githubusercontent.com/kittycapital/kittycapital.github.io/main/assets/herdvibe-og.png';

function ensureKakao(){try{if(typeof Kakao!=='undefined'&&!Kakao.isInitialized())Kakao.init(KAKAO_KEY);return typeof Kakao!=='undefined'&&Kakao.isInitialized();}catch(e){return false;}}
function copyToClipboard(t){try{window.parent.postMessage({type:'clipboard',text:t},'*');}catch(e){}try{navigator.clipboard.writeText(t);}catch(e){}}
function flashCopied(btn){if(!btn)return;var orig=btn.innerHTML;btn.style.background='#22c55e';btn.style.color='#fff';btn.style.borderColor='#22c55e';var hasLabel=btn.querySelector('.lbl');btn.innerHTML='<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round"><path d="M5 13l4 4L19 7"/></svg>'+(hasLabel?'<span class="lbl" style="color:#fff">ë³µì‚¬ë¨!</span>':'');setTimeout(function(){btn.style.background='';btn.style.color='';btn.style.borderColor='';btn.innerHTML=orig;},2000);}
function kakaoShare(title){var url=SHARE_URL;if(!ensureKakao()){copyToClipboard(url);showToast('ë§í¬ ë³µì‚¬ì™„ë£Œ! ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”');return;}try{Kakao.Share.sendDefault({objectType:'feed',content:{title:title||document.title,description:'ë©€í‹° ìì‚° íˆ¬ì ì‹œë®¬ë ˆì´í„° â€” herdvibe.com',imageUrl:OG_IMAGE,link:{mobileWebUrl:url,webUrl:url}},buttons:[{title:'ëŒ€ì‹œë³´ë“œ ë³´ê¸°',link:{mobileWebUrl:url,webUrl:url}}]});}catch(e){copyToClipboard(url);showToast('ë§í¬ ë³µì‚¬ì™„ë£Œ! ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”');}}
function showToast(msg){var w=document.querySelector('.toast-wrap');if(!w){w=document.createElement('div');w.className='toast-wrap';w.style.cssText='position:fixed;bottom:20px;right:20px;z-index:999';document.body.appendChild(w);}var t=document.createElement('div');t.style.cssText='background:#1a1a2a;border:1px solid #282845;border-left:3px solid #00ff88;border-radius:8px;padding:10px 18px;font-size:12px;color:#e8e8f0;box-shadow:0 8px 32px rgba(0,0,0,.7);animation:toastIn .3s ease';t.textContent=msg;w.appendChild(t);setTimeout(function(){t.style.opacity='0';t.style.transform='translateY(12px)';t.style.transition='.3s';setTimeout(function(){t.remove();},300);},3000);}
function doShare(platform,btn){var url=SHARE_URL;var title=document.title+' â€” herdvibe.com';switch(platform){case'twitter':window.open('https://twitter.com/intent/tweet?text='+encodeURIComponent(title)+'&url='+encodeURIComponent(url),'_blank');break;case'telegram':window.open('https://t.me/share/url?url='+encodeURIComponent(url)+'&text='+encodeURIComponent(title),'_blank');break;case'kakao':kakaoShare(title);break;case'instagram':copyToClipboard(url);flashCopied(btn);showToast('ë§í¬ ë³µì‚¬ì™„ë£Œ! ì¸ìŠ¤íƒ€ê·¸ë¨ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”');break;case'link':copyToClipboard(url);flashCopied(btn);showToast('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤ âœ“');break;}}
</script>
<script type="text/babel">
const {useState,useMemo,useCallback,useEffect,useRef,memo}=React;

if(typeof ASSET_DATA==='undefined'){
  document.getElementById('root').innerHTML='<div style="color:#ff4466;padding:40px;text-align:center"><h2>ì˜¤ë¥˜: data.js íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h2><p>data.js íŒŒì¼ì´ ì˜¬ë°”ë¥¸ ê²½ë¡œì— ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”</p></div>';
  throw new Error('ASSET_DATA not defined');
}

/* ===== ìƒìˆ˜ ===== */
const ASSETS=['SPY','QQQ','DIA','IWM','BTC_USD','ETH_USD','GLD','SLV','USO','TLT','EEM','EWY','XLE','SCHD','ARKK'];

const KR_LABELS={
  SPY:'S&P 500 (SPY)',QQQ:'ë‚˜ìŠ¤ë‹¥ 100 (QQQ)',DIA:'ë‹¤ìš°ì¡´ìŠ¤ (DIA)',IWM:'ëŸ¬ì…€ 2000 (IWM)',
  BTC_USD:'ë¹„íŠ¸ì½”ì¸ (BTC)',ETH_USD:'ì´ë”ë¦¬ì›€ (ETH)',
  GLD:'ê¸ˆ (GLD)',SLV:'ì€ (SLV)',USO:'ì›ìœ  (USO)',
  TLT:'ë¯¸êµ­ì±„ 20ë…„ (TLT)',EEM:'ì‹ í¥êµ­ (EEM)',EWY:'í•œêµ­ (EWY)',
  XLE:'ì—ë„ˆì§€ (XLE)',SCHD:'ë°°ë‹¹ ETF (SCHD)',ARKK:'ARKK í˜ì‹ '
};

const COLORS={SPY:'#00ff88',QQQ:'#4488ff',DIA:'#ffcc00',IWM:'#ff8844',BTC_USD:'#f7931a',ETH_USD:'#627eea',GLD:'#ffd700',SLV:'#c0c0c0',USO:'#8b6914',TLT:'#00ccee',EEM:'#aa66ff',EWY:'#ff4466',XLE:'#44cc44',SCHD:'#ff66aa',ARKK:'#cc44ff'};

const LIFE_EVENTS=[
  {l:'ëŒ€í•™ ì¡¸ì—… (2000ë…„)',y:2000},{l:'ëŒ€í•™ ì¡¸ì—… (2005ë…„)',y:2005},
  {l:'2008 ê¸ˆìœµìœ„ê¸° ì§ì „',y:2007},{l:'2008 ê¸ˆìœµìœ„ê¸° ì§í›„',y:2009},
  {l:'ì‚¬íšŒ ì´ˆë…„ìƒ (2010ë…„)',y:2010},{l:'íˆ¬ì ì‹œì‘ (2015ë…„)',y:2015},
  {l:'ì½”ë¡œë‚˜ ì§ì „ (2019ë…„)',y:2019},{l:'ì½”ë¡œë‚˜ ë½ë‹¤ìš´ (2020ë…„)',y:2020},
  {l:'ì½”ì¸ ë¶ˆì¥ (2021ë…„)',y:2021},{l:'2022 í•˜ë½ì¥ ë°”ë‹¥',y:2022}
];

function lb(ticker){return KR_LABELS[ticker]||ticker;}

/* ===== ì—”ì§„ ===== */
function calcSMA(p,n){var s=new Array(p.length).fill(null);for(var i=n-1;i<p.length;i++){var sum=0;for(var j=i-n+1;j<=i;j++)sum+=p[j];s[i]=sum/n;}return s;}
function calcRSI(p,n){var r=new Array(p.length).fill(null);if(p.length<n+1)return r;var g=0,l=0;for(var i=1;i<=n;i++){var c=p[i]-p[i-1];if(c>0)g+=c;else l-=c;}var ag=g/n,al=l/n;r[n]=al===0?100:100-100/(1+ag/al);for(var i=n+1;i<p.length;i++){var c=p[i]-p[i-1];ag=(ag*(n-1)+Math.max(c,0))/n;al=(al*(n-1)+Math.max(-c,0))/n;r[i]=al===0?100:100-100/(1+ag/al);}return r;}
function calcDD(p){var d=new Array(p.length).fill(0);var pk=p[0];for(var i=1;i<p.length;i++){if(p[i]>pk)pk=p[i];d[i]=(p[i]-pk)/pk;}return d;}
function findIdx(dates,t){for(var i=0;i<dates.length;i++){if(dates[i]>=t)return i;}return dates.length-1;}
function getStart(yrs){var d=new Date();d.setFullYear(d.getFullYear()-yrs);return d.toISOString().split('T')[0];}

function runStrategy(ticker,sType,params,startDate,endDate){
  var raw=ASSET_DATA[ticker];if(!raw)return null;
  var dates=raw.dates,prices=raw.prices;
  var si=findIdx(dates,startDate),ei=endDate?findIdx(dates,endDate):dates.length-1;
  if(si>=ei)return null;
  var budget=params.budget||500,frequency=params.frequency||'monthly',maPeriod=params.maPeriod||200,maThreshold=params.maThreshold||0,dipThreshold=params.dipThreshold||-10,rsiThreshold=params.rsiThreshold||30;
  var sma=calcSMA(prices,maPeriod),rsi=calcRSI(prices,14),dd=calcDD(prices);
  var shares=0,invested=0,lastM=-1,lastW=-1;
  var curve=[];
  var bhStart=prices[si];

  for(var i=si;i<=ei;i++){
    var date=dates[i],price=prices[i],dt=new Date(date);
    var mo=dt.getFullYear()*12+dt.getMonth(),wk=Math.floor(dt.getTime()/(7*864e5));
    var buy=false,amt=budget;

    if(sType==='dca'){
      if(frequency==='daily'){buy=true;amt=budget/21;}
      else if(frequency==='weekly'){if(wk!==lastW){buy=true;amt=budget/4.33;lastW=wk;}}
      else{if(mo!==lastM){buy=true;lastM=mo;}}
    }else if(sType==='ma'){
      if(mo!==lastM&&sma[i]!==null){lastM=mo;var pct=(price-sma[i])/sma[i]*100;if(pct<=maThreshold){buy=true;amt=budget*Math.min(3,1+Math.abs(pct-maThreshold)/10);}}
    }else if(sType==='dip'){
      if(mo!==lastM){lastM=mo;var dp=dd[i]*100,rs=rsi[i];if(dp<=dipThreshold||(rs!==null&&rs<=rsiThreshold)){buy=true;amt=budget*Math.min(3,1+Math.abs(dp)/15);}else{buy=true;amt=budget*0.3;}}
    }else if(sType==='hybrid'){
      if(mo!==lastM){lastM=mo;buy=true;amt=budget*0.5;if(sma[i]!==null&&price<sma[i])amt+=budget*0.25;if(dd[i]*100<=dipThreshold)amt+=budget*0.5;if(rsi[i]!==null&&rsi[i]<=rsiThreshold)amt+=budget*0.25;}
    }

    if(buy&&amt>0){shares+=amt/price;invested+=amt;}
    var val=shares*price;
    var bh=invested>0?(invested/bhStart)*price:0;
    curve.push({date:date,value:Math.round(val*100)/100,invested:Math.round(invested*100)/100,buyHold:Math.round(bh*100)/100});
  }

  if(curve.length===0||invested===0)return null;
  var fv=curve[curve.length-1].value;
  var yrs=(new Date(dates[ei])-new Date(dates[si]))/(365.25*864e5);
  var tr=((fv-invested)/invested)*100;
  var cagr=yrs>0?(Math.pow(fv/invested,1/yrs)-1)*100:0;
  var pk2=0,mdd=0;
  for(var j=0;j<curve.length;j++){if(curve[j].value>pk2)pk2=curve[j].value;var d2=pk2>0?(curve[j].value-pk2)/pk2:0;if(d2<mdd)mdd=d2;}
  var bhF=curve[curve.length-1].buyHold;
  var bhR=invested>0?((bhF-invested)/invested)*100:0;

  return{ticker:ticker,label:lb(ticker),curve:curve,invested:invested,finalValue:fv,totalReturn:tr,cagr:cagr,maxDD:mdd*100,avgCost:shares>0?invested/shares:0,shares:shares,bhFinal:bhF,bhReturn:bhR,years:yrs,numBuys:curve.filter(function(_,idx,a){return idx===0||a[idx].invested!==a[idx-1].invested;}).length};
}

/* ===== í¬ë§· ===== */
function fmt(n){if(Math.abs(n)>=1e6)return'$'+(n/1e6).toFixed(2)+'M';if(Math.abs(n)>=1e3)return'$'+(n/1e3).toFixed(1)+'K';return'$'+n.toFixed(2);}
function fPct(n){return(n>=0?'+':'')+n.toFixed(2)+'%';}
function fNum(n){return n.toLocaleString(undefined,{maximumFractionDigits:2});}

/* ===== ìº”ë²„ìŠ¤ ì°¨íŠ¸ (íƒ€ì„ë¨¸ì‹ ìš©) ===== */
function CanvasChart(props){
  var results=props.results,height=props.height||380,showBH=props.showBH!==false;
  var canvasRef=useRef(null);
  var wrapRef=useRef(null);
  var s1=useState(null),tip=s1[0],setTip=s1[1];

  var chartData=useMemo(function(){
    if(!results||!results.length)return null;
    var longest=results[0];
    for(var i=1;i<results.length;i++){if(results[i].curve.length>longest.curve.length)longest=results[i];}
    var raw=longest.curve;
    var step=Math.max(1,Math.floor(raw.length/600));
    var sampled=[];
    for(var i=0;i<raw.length;i++){if(i%step===0||i===raw.length-1)sampled.push(i);}
    return sampled.map(function(idx){
      var pt={date:longest.curve[idx].date};
      results.forEach(function(r){if(r.curve[idx]){pt[r.ticker]=r.curve[idx].value;pt[r.ticker+'_bh']=r.curve[idx].buyHold;}});
      return pt;
    });
  },[results]);

  useEffect(function(){
    if(!canvasRef.current||!wrapRef.current||!chartData||!chartData.length)return;
    var canvas=canvasRef.current,wrap=wrapRef.current;
    var w=wrap.clientWidth,h=height;
    var dpr=window.devicePixelRatio||1;
    canvas.width=w*dpr;canvas.height=h*dpr;
    canvas.style.width=w+'px';canvas.style.height=h+'px';
    var ctx=canvas.getContext('2d');ctx.scale(dpr,dpr);

    var pad={t:24,r:16,b:32,l:66};
    var cw=w-pad.l-pad.r,ch=h-pad.t-pad.b;
    if(cw<40||ch<40)return;

    var yMin=Infinity,yMax=-Infinity;
    chartData.forEach(function(pt){
      results.forEach(function(r){
        if(pt[r.ticker]!==undefined){yMin=Math.min(yMin,pt[r.ticker]);yMax=Math.max(yMax,pt[r.ticker]);}
        if(showBH&&pt[r.ticker+'_bh']!==undefined){yMin=Math.min(yMin,pt[r.ticker+'_bh']);yMax=Math.max(yMax,pt[r.ticker+'_bh']);}
      });
    });
    if(yMin===yMax){yMin*=0.9;yMax*=1.1;}
    var yP=(yMax-yMin)*0.08;yMin=Math.max(0,yMin-yP);yMax+=yP;
    var xPos=function(i){return pad.l+(i/(chartData.length-1))*cw;};
    var yPos=function(v){return pad.t+ch-(v-yMin)/(yMax-yMin)*ch;};

    ctx.clearRect(0,0,w,h);

    ctx.strokeStyle='#1a1a2e';ctx.lineWidth=1;
    ctx.fillStyle='#505068';ctx.font='9px JetBrains Mono,monospace';ctx.textAlign='right';
    var yStep=Math.pow(10,Math.floor(Math.log10((yMax-yMin)/4)));
    if((yMax-yMin)/yStep>8)yStep*=2;
    for(var yt=Math.ceil(yMin/yStep)*yStep;yt<=yMax;yt+=yStep){
      var yy=yPos(yt);ctx.beginPath();ctx.moveTo(pad.l,yy);ctx.lineTo(w-pad.r,yy);ctx.stroke();
      ctx.fillText(fmt(yt),pad.l-6,yy+3);
    }
    ctx.textAlign='center';
    var lStep=Math.max(1,Math.floor(chartData.length/7));
    for(var i=0;i<chartData.length;i+=lStep){
      var d=chartData[i].date;
      ctx.fillText(d.slice(0,4)+'.'+d.slice(5,7),xPos(i),h-8);
    }

    if(showBH){
      ctx.setLineDash([4,4]);ctx.lineWidth=1.5;ctx.strokeStyle='#8888aa';
      results.forEach(function(r){
        ctx.beginPath();var started=false;
        for(var i=0;i<chartData.length;i++){
          if(chartData[i][r.ticker+'_bh']!==undefined){
            var xx=xPos(i),yy2=yPos(chartData[i][r.ticker+'_bh']);
            if(!started){ctx.moveTo(xx,yy2);started=true;}else{ctx.lineTo(xx,yy2);}
          }
        }
        ctx.stroke();
      });
      ctx.setLineDash([]);
    }

    results.forEach(function(r){
      ctx.strokeStyle=COLORS[r.ticker];ctx.lineWidth=2.5;ctx.lineJoin='round';ctx.lineCap='round';
      ctx.beginPath();var started=false;
      for(var i=0;i<chartData.length;i++){
        if(chartData[i][r.ticker]!==undefined){
          var xx=xPos(i),yy2=yPos(chartData[i][r.ticker]);
          if(!started){ctx.moveTo(xx,yy2);started=true;}else{ctx.lineTo(xx,yy2);}
        }
      }
      ctx.stroke();
    });

    canvas._chartMeta={pad:pad,cw:cw,data:chartData,results:results};
  },[chartData,results,height,showBH]);

  var handleMouse=function(e){
    if(!canvasRef.current||!canvasRef.current._chartMeta)return;
    var rect=canvasRef.current.getBoundingClientRect();
    var mx=e.clientX-rect.left;
    var meta=canvasRef.current._chartMeta;
    var relX=mx-meta.pad.l;
    if(relX<0||relX>meta.cw){setTip(null);return;}
    var idx=Math.round((relX/meta.cw)*(meta.data.length-1));
    var pt=meta.data[Math.min(idx,meta.data.length-1)];
    if(!pt){setTip(null);return;}
    var vals=[];
    meta.results.forEach(function(r){if(pt[r.ticker]!==undefined)vals.push({ticker:r.ticker,label:lb(r.ticker),value:pt[r.ticker],color:COLORS[r.ticker]});});
    setTip({x:e.clientX-rect.left,y:e.clientY-rect.top,date:pt.date,vals:vals});
  };

  if(!results||!results.length)return null;

  return React.createElement('div',{ref:wrapRef,className:'chart-wrap',style:{height:height},onMouseMove:handleMouse,onMouseLeave:function(){setTip(null);}},
    React.createElement('canvas',{ref:canvasRef,style:{display:'block'}}),
    React.createElement('div',{style:{position:'absolute',top:4,right:8,display:'flex',gap:12,flexWrap:'wrap'}},
      results.map(function(r){return React.createElement('div',{key:r.ticker,style:{display:'flex',alignItems:'center',gap:4,fontSize:10,color:COLORS[r.ticker]}},React.createElement('div',{style:{width:10,height:3,background:COLORS[r.ticker],borderRadius:2}}),lb(r.ticker));})
    ),
    tip&&React.createElement('div',{style:{position:'absolute',left:Math.min(tip.x+12,(wrapRef.current?wrapRef.current.clientWidth:800)-180),top:Math.max(tip.y-60,8),background:'#0d0d16ee',border:'1px solid #282845',borderRadius:8,padding:'8px 10px',fontSize:10,pointerEvents:'none',zIndex:10,minWidth:140}},
      React.createElement('div',{style:{color:'#9090a8',marginBottom:4,fontFamily:'JetBrains Mono,monospace'}},tip.date),
      tip.vals.map(function(v){return React.createElement('div',{key:v.ticker,style:{display:'flex',justifyContent:'space-between',gap:16,marginBottom:2}},React.createElement('span',{style:{color:v.color,fontWeight:600}},v.label),React.createElement('span',{style:{fontFamily:'JetBrains Mono,monospace',color:'#00ff88'}},fmt(v.value)));})
    )
  );
}

/* ===== ë„ì›€ë§ ë°•ìŠ¤ ===== */
function HelpBox(props){
  var s1=useState(false),open=s1[0],setOpen=s1[1];
  return React.createElement('div',{className:'helpbox'},
    React.createElement('button',{className:'helpbtn',onClick:function(){setOpen(!open);}},
      React.createElement('span',{className:'arrow'+(open?' open':'')},'\u25B6'),
      'â„¹ï¸ ì‚¬ìš©ë²• & ìš©ì–´ ì„¤ëª…'
    ),
    open&&React.createElement('div',{className:'helpcontent'},
      props.children,
      React.createElement('div',{className:'glossary'},
        React.createElement('div',{style:{fontWeight:700,color:'var(--t1)',marginBottom:6,fontSize:11}},'ğŸ“– ìš©ì–´ ì„¤ëª…'),
        React.createElement('div',{className:'gi'},React.createElement('span',{className:'gt'},'CAGR'),React.createElement('span',{className:'gd'},'ì—°í‰ê·  ë³µë¦¬ ìˆ˜ìµë¥ . ì˜ˆ: 10ë…„ê°„ +100% ìˆ˜ìµì´ë©´ CAGR â‰ˆ +7.2%')),
        React.createElement('div',{className:'gi'},React.createElement('span',{className:'gt'},'MDD'),React.createElement('span',{className:'gd'},'ìµœëŒ€ ë‚™í­. ê³ ì  ëŒ€ë¹„ ê°€ì¥ í¬ê²Œ ë–¨ì–´ì§„ í­. -30%ë©´ ìì‚°ì´ ìµœëŒ€ 30% ê°ì†Œí•œ ì  ìˆìŒ')),
        React.createElement('div',{className:'gi'},React.createElement('span',{className:'gt'},'ê±°ì¹˜ì‹'),React.createElement('span',{className:'gd'},'ì „ì²´ íˆ¬ìê¸ˆì„ ì²«ë‚  í•œ ë²ˆì— íˆ¬ì…í•˜ëŠ” ë°©ì‹. ì ë¦½ì‹ê³¼ ì„±ê³¼ë¥¼ ë¹„êµí•˜ëŠ” ê¸°ì¤€ì„ ')),
        React.createElement('div',{className:'gi'},React.createElement('span',{className:'gt'},'RSI'),React.createElement('span',{className:'gd'},'ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ì§€í‘œ. 30 ì´í•˜ = ê³¼ë§¤ë„(ë§¤ìˆ˜ ì‹ í˜¸), 70 ì´ìƒ = ê³¼ë§¤ìˆ˜')),
        React.createElement('div',{className:'gi'},React.createElement('span',{className:'gt'},'ì´í‰ì„ '),React.createElement('span',{className:'gd'},'ì´ë™í‰ê· ì„ . ì¼ì • ê¸°ê°„ ë™ì•ˆì˜ í‰ê·  ê°€ê²©. 200ì¼ì„ ì´ ëŒ€í‘œì '))
      )
    )
  );
}

/* ===== ì „ëµ ì„¤ëª… ì»´í¬ë„ŒíŠ¸ ===== */
function getStratExplain(label){
  if(!label)return null;
  if(label.indexOf('ì ë¦½ì‹')>=0){
    var freq=label.indexOf('ë§¤ì›”')>=0?'ë§¤ì›”':label.indexOf('ë§¤ì£¼')>=0?'ë§¤ì£¼':'ë§¤ì¼';
    return freq+' ë™ì¼ ê¸ˆì•¡ì„ ë§¤ìˆ˜í•©ë‹ˆë‹¤.\nâ€¢ ì‹œì¥ ìƒí™©ê³¼ ê´€ê³„ì—†ì´ ì •í•´ì§„ ì£¼ê¸°ë§ˆë‹¤ ê¸°ê³„ì ìœ¼ë¡œ ë§¤ìˆ˜\nâ€¢ í•˜ë½ì¥ì—ì„œ ë” ë§ì€ ìˆ˜ëŸ‰, ìƒìŠ¹ì¥ì—ì„œ ì ì€ ìˆ˜ëŸ‰ì„ ì‚¬ëŠ” íš¨ê³¼\nâ€¢ í‰ê·  ë§¤ì… ë‹¨ê°€ë¥¼ ë‚®ì¶”ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ì „ëµ';
  }
  if(label.indexOf('ì´í‰ì„ ')>=0||label.indexOf('ì´í‰')>=0){
    var mMatch=label.match(/(\d+)ì¼/),tMatch=label.match(/([-]?\d+)%/);
    var days=mMatch?mMatch[1]:'200',thresh=tMatch?tMatch[1]:'0';
    var tNum=parseInt(thresh);
    return 'ì£¼ê°€ê°€ '+days+'ì¼ ì´ë™í‰ê· ì„ '+(tNum===0?' ì•„ë˜':'ë³´ë‹¤ '+Math.abs(tNum)+'% ì´ìƒ ì•„ë˜')+'ì¼ ë•Œ ë§¤ìˆ˜í•©ë‹ˆë‹¤.\nâ€¢ '+days+'ì¼ = ì•½ '+(Math.round(parseInt(days)/20))+'ê°œì›”ê°„ì˜ í‰ê·  ì£¼ê°€ë¥¼ ê¸°ì¤€ì„ ìœ¼ë¡œ ì‚¬ìš©\nâ€¢ '+thresh+'% = ì´í‰ì„ '+(tNum===0?' ë°”ë¡œ ì•„ë˜ë¶€í„° ë§¤ìˆ˜ (ì¶”ê°€ í• ì¸ ì—†ì´)':'ë³´ë‹¤ '+Math.abs(tNum)+'% ë” ë–¨ì–´ì ¸ì•¼ ë§¤ìˆ˜ ì‹ í˜¸ ë°œë™')+'\nâ€¢ ì£¼ê°€ê°€ ê¸°ì¤€ ìœ„ì— ìˆìœ¼ë©´ ë§¤ìˆ˜í•˜ì§€ ì•Šê³  ëŒ€ê¸°';
  }
  if(label.indexOf('ê¸‰ë½')>=0){
    var dMatch=label.match(/([-]?\d+)%/),rMatch=label.match(/RSI\s*(\d+)/);
    var dip=dMatch?dMatch[1]:'-10',rsi=rMatch?rMatch[1]:'30';
    var severe=Math.abs(parseInt(dip))>=20;
    return 'ê³ ì  ëŒ€ë¹„ '+Math.abs(parseInt(dip))+'% ì´ìƒ í•˜ë½í•˜ê³  RSIê°€ '+rsi+' ì´í•˜ì¼ ë•Œ ë§¤ìˆ˜í•©ë‹ˆë‹¤.\nâ€¢ '+dip+'% = ìµœê·¼ ìµœê³ ê°€ì—ì„œ '+Math.abs(parseInt(dip))+'% ì´ìƒ ë–¨ì–´ì§„ ìƒíƒœ\nâ€¢ RSI '+rsi+' = ê³¼ë§¤ë„ êµ¬ê°„ (ìˆ«ìê°€ ë‚®ì„ìˆ˜ë¡ ë” ë§ì´ ë¹ ì§„ ìƒíƒœ)\nâ€¢ ë‘ ì¡°ê±´ ëª¨ë‘ ì¶©ì¡±í•´ì•¼ ë§¤ìˆ˜'+(severe?'\nâ€¢ ì¡°ê±´ì´ ë§¤ìš° ê¹Œë‹¤ë¡œì›Œ ëª‡ ë…„ì— í•œ ë²ˆë§Œ ë°œë™ (ê¸ˆìœµìœ„ê¸°Â·ì½”ë¡œë‚˜ê¸‰ í­ë½)':'');
  }
  if(label.indexOf('í•˜ì´ë¸Œë¦¬ë“œ')>=0){
    var hMA=label.match(/MA(\d+)/),hDip=label.match(/([-]?\d+)%/);
    var maD=hMA?hMA[1]:'200',dipD=hDip?Math.abs(parseInt(hDip[1])):'10';
    return 'í‰ì†Œì—” ë§¤ì›” ì ë¦½ì‹ìœ¼ë¡œ ê¾¸ì¤€íˆ ë§¤ìˆ˜ + ê¸‰ë½ ì‹œ ì¶”ê°€ ë§¤ìˆ˜í•©ë‹ˆë‹¤.\nâ€¢ ê¸°ë³¸: ë§¤ì›” ì •ì•¡ ë§¤ìˆ˜ (ì ë¦½ì‹)\nâ€¢ ì¶”ê°€ ë§¤ìˆ˜ ì¡°ê±´: '+maD+'ì¼ ì´í‰ì„  ì´íƒˆ ë˜ëŠ” ê³ ì  ëŒ€ë¹„ '+dipD+'%â†“ + RSI 30 ì´í•˜\nâ€¢ ê¾¸ì¤€í•¨ + ê¸°íšŒ í¬ì°©ì„ ë™ì‹œì— ì¶”êµ¬í•˜ëŠ” ì „ëµ';
  }
  return null;
}

function StratExplain(props){
  var label=props.label;
  var s=useState(false),open=s[0],setOpen=s[1];
  var text=getStratExplain(label);
  if(!text)return null;
  return React.createElement('div',{style:{marginTop:open?8:4}},
    React.createElement('div',{onClick:function(e){e.stopPropagation();setOpen(!open);},style:{fontSize:10,color:'var(--t3)',cursor:'pointer',display:'flex',alignItems:'center',gap:4}},
      React.createElement('span',{style:{fontSize:8,transition:'.2s',transform:open?'rotate(90deg)':'rotate(0deg)',display:'inline-block'}},'â–¶'),
      'ì „ëµ ì„¤ëª…'
    ),
    open&&React.createElement('div',{style:{marginTop:6,padding:'8px 10px',background:'rgba(255,255,255,.03)',borderRadius:6,border:'1px solid var(--bdr)',fontSize:10,color:'var(--t2)',lineHeight:1.8,whiteSpace:'pre-line'},onClick:function(e){e.stopPropagation();}},text)
  );
}

/* ===== ë¹„êµ ì°¨íŠ¸ (í¬íŠ¸í´ë¦¬ì˜¤ìš©) ===== */
function ComparisonChart(props){
  var portfolios=props.portfolios,height=props.height||340;
  var canRef=useRef(null),wRef=useRef(null);
  var s1=useState(null),tip=s1[0],setTip=s1[1];
  useEffect(function(){
    if(!canRef.current||!wRef.current||!portfolios||!portfolios.length)return;
    var c=canRef.current,wrap=wRef.current;
    var w=wrap.clientWidth,h=height;
    var dpr=window.devicePixelRatio||1;
    c.width=w*dpr;c.height=h*dpr;c.style.width=w+'px';c.style.height=h+'px';
    var ctx=c.getContext('2d');ctx.scale(dpr,dpr);
    var pad={t:16,r:16,b:30,l:66};
    var cw=w-pad.l-pad.r,ch=h-pad.t-pad.b;
    if(cw<40||ch<40)return;
    var yMin=Infinity,yMax=-Infinity;
    portfolios.forEach(function(p){p.pfCurve.forEach(function(v){if(v<yMin)yMin=v;if(v>yMax)yMax=v;});});
    if(yMin===yMax){yMin*=0.9;yMax*=1.1;}
    var yP2=(yMax-yMin)*0.08;yMin=Math.max(0,yMin-yP2);yMax+=yP2;
    var maxLen=0;portfolios.forEach(function(p){if(p.pfCurve.length>maxLen)maxLen=p.pfCurve.length;});
    var xPos=function(i,len){return pad.l+(i/(len-1))*cw;};
    var yPos=function(v){return pad.t+ch-(v-yMin)/(yMax-yMin)*ch;};

    ctx.clearRect(0,0,w,h);
    ctx.strokeStyle='#1a1a2e';ctx.lineWidth=1;ctx.fillStyle='#686880';ctx.font='9px JetBrains Mono,monospace';ctx.textAlign='right';
    var yStep=Math.pow(10,Math.floor(Math.log10((yMax-yMin)/4)));
    if((yMax-yMin)/yStep>8)yStep*=2;
    for(var yt=Math.ceil(yMin/yStep)*yStep;yt<=yMax;yt+=yStep){
      var yy=yPos(yt);ctx.beginPath();ctx.moveTo(pad.l,yy);ctx.lineTo(w-pad.r,yy);ctx.stroke();
      ctx.fillText(fmt(yt),pad.l-6,yy+3);
    }
    var longest=portfolios[0];portfolios.forEach(function(p){if(p.pfDates.length>longest.pfDates.length)longest=p;});
    ctx.textAlign='center';
    var lStep2=Math.max(1,Math.floor(longest.pfDates.length/7));
    for(var i=0;i<longest.pfDates.length;i+=lStep2){
      var d=longest.pfDates[i];
      if(d)ctx.fillText(d.slice(0,4)+'.'+d.slice(5,7),xPos(i,longest.pfDates.length),h-8);
    }
    portfolios.forEach(function(p){
      var pts=p.pfCurve;var s2=Math.max(1,Math.floor(pts.length/300));
      ctx.beginPath();ctx.moveTo(xPos(0,pts.length),h-pad.b);
      for(var i=0;i<pts.length;i+=s2){ctx.lineTo(xPos(i,pts.length),yPos(pts[i]));}
      ctx.lineTo(xPos(pts.length-1,pts.length),yPos(pts[pts.length-1]));
      ctx.lineTo(xPos(pts.length-1,pts.length),h-pad.b);ctx.closePath();
      var grad=ctx.createLinearGradient(0,0,0,h);
      grad.addColorStop(0,p.pfColor+'18');grad.addColorStop(1,p.pfColor+'03');
      ctx.fillStyle=grad;ctx.fill();
      ctx.beginPath();ctx.strokeStyle=p.pfColor;ctx.lineWidth=2.5;ctx.lineJoin='round';ctx.lineCap='round';
      var started=false;
      for(var i=0;i<pts.length;i+=s2){
        var xx=xPos(i,pts.length),yy2=yPos(pts[i]);
        if(!started){ctx.moveTo(xx,yy2);started=true;}else ctx.lineTo(xx,yy2);
      }
      ctx.lineTo(xPos(pts.length-1,pts.length),yPos(pts[pts.length-1]));
      ctx.stroke();
    });
    c._meta={pad:pad,cw:cw,portfolios:portfolios};
  },[portfolios,height]);

  var handleMouse=function(e){
    if(!canRef.current||!canRef.current._meta)return;
    var rect=canRef.current.getBoundingClientRect();
    var mx=e.clientX-rect.left;
    var meta=canRef.current._meta;
    var relX=mx-meta.pad.l;
    if(relX<0||relX>meta.cw){setTip(null);return;}
    var pct=relX/meta.cw;
    var vals=meta.portfolios.map(function(p){
      var idx=Math.round(pct*(p.pfCurve.length-1));
      idx=Math.min(idx,p.pfCurve.length-1);
      return{name:p.name.replace(/[^\w\sã„±-í£]/g,'').trim(),value:p.pfCurve[idx],color:p.pfColor,date:p.pfDates[idx]};
    });
    setTip({x:e.clientX-rect.left,y:e.clientY-rect.top,vals:vals});
  };

  return React.createElement('div',{ref:wRef,style:{width:'100%',height:height,position:'relative'},onMouseMove:handleMouse,onMouseLeave:function(){setTip(null);}},
    React.createElement('canvas',{ref:canRef,style:{display:'block'}}),
    tip&&React.createElement('div',{style:{position:'absolute',left:Math.min(tip.x+12,(wRef.current?wRef.current.clientWidth:800)-200),top:Math.max(tip.y-80,8),background:'#0d0d16ee',border:'1px solid #282845',borderRadius:8,padding:'8px 10px',fontSize:10,pointerEvents:'none',zIndex:10,minWidth:160}},
      tip.vals[0]&&tip.vals[0].date&&React.createElement('div',{style:{color:'#9090a8',marginBottom:4,fontFamily:'JetBrains Mono,monospace'}},tip.vals[0].date),
      tip.vals.map(function(v,i){return React.createElement('div',{key:i,style:{display:'flex',justifyContent:'space-between',gap:16,marginBottom:2}},React.createElement('span',{style:{color:v.color,fontWeight:600}},v.name),React.createElement('span',{style:{fontFamily:'JetBrains Mono,monospace',color:'var(--g)'}},fmt(v.value)));})
    )
  );
}

/* ===== ìŠ¤íŒŒí¬ë¼ì¸ ===== */
function Sparkline(props){
  var data=props.data,color=props.color||'#00ff88',h=props.height||100;
  var canRef=useRef(null),wRef=useRef(null);
  useEffect(function(){
    if(!canRef.current||!wRef.current||!data||!data.length)return;
    var c=canRef.current,w=wRef.current.clientWidth;
    var dpr=window.devicePixelRatio||1;
    c.width=w*dpr;c.height=h*dpr;c.style.width=w+'px';c.style.height=h+'px';
    var ctx=c.getContext('2d');ctx.scale(dpr,dpr);
    var pad=4,cw=w-pad*2,ch=h-pad*2;
    var mn=Infinity,mx=-Infinity;
    data.forEach(function(v){if(v<mn)mn=v;if(v>mx)mx=v;});
    if(mn===mx){mn*=0.9;mx*=1.1;}
    var step=Math.max(1,Math.floor(data.length/300));
    var pts=[];for(var i=0;i<data.length;i+=step)pts.push(data[i]);if(pts[pts.length-1]!==data[data.length-1])pts.push(data[data.length-1]);
    ctx.beginPath();
    ctx.moveTo(pad,h-pad);
    pts.forEach(function(v,i){var x=pad+(i/(pts.length-1))*cw;var y=pad+ch-(v-mn)/(mx-mn)*ch;ctx.lineTo(x,y);});
    ctx.lineTo(pad+cw,h-pad);ctx.closePath();
    var grad=ctx.createLinearGradient(0,0,0,h);
    grad.addColorStop(0,color+'40');grad.addColorStop(1,color+'05');
    ctx.fillStyle=grad;ctx.fill();
    ctx.beginPath();ctx.strokeStyle=color;ctx.lineWidth=2;ctx.lineJoin='round';
    pts.forEach(function(v,i){var x=pad+(i/(pts.length-1))*cw;var y=pad+ch-(v-mn)/(mx-mn)*ch;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);});
    ctx.stroke();
  },[data,color,h]);
  if(!data||!data.length)return null;
  return React.createElement('div',{ref:wRef,style:{width:'100%',height:h,marginBottom:8}},React.createElement('canvas',{ref:canRef,style:{display:'block'}}));
}

/* ===== íƒ­ 1: íƒ€ì„ë¨¸ì‹  ===== */
function TimeMachine(){
  var s1=useState(0),evt=s1[0],setE=s1[1];
  var s2=useState(''),cYear=s2[0],setCY=s2[1];
  var s3=useState(500),budget=s3[0],setB=s3[1];
  var s4=useState(null),res=s4[0],setR=s4[1];
  var s5=useState(false),busy=s5[0],setBusy=s5[1];

  var run=function(){setBusy(true);setTimeout(function(){
    var yr=cYear?parseInt(cYear):LIFE_EVENTS[evt].y;
    var sd=yr+'-01-01';
    var strats=[
      {t:'dca',l:'ì ë¦½ì‹ (ë§¤ì›”)',p:{budget:budget,frequency:'monthly'}},
      {t:'dca',l:'ì ë¦½ì‹ (ë§¤ì£¼)',p:{budget:budget,frequency:'weekly'}},
      {t:'ma',l:'ì´í‰ì„  (200ì¼, 0%)',p:{budget:budget,maPeriod:200,maThreshold:0}},
      {t:'ma',l:'ì´í‰ì„  (50ì¼, -5%)',p:{budget:budget,maPeriod:50,maThreshold:-5}},
      {t:'dip',l:'ê¸‰ë½ ë§¤ìˆ˜ (-10%, RSI 30)',p:{budget:budget,dipThreshold:-10,rsiThreshold:30}},
      {t:'dip',l:'ê¸‰ë½ ë§¤ìˆ˜ (-20%, RSI 25)',p:{budget:budget,dipThreshold:-20,rsiThreshold:25}},
      {t:'hybrid',l:'í•˜ì´ë¸Œë¦¬ë“œ (MA200, -10%)',p:{budget:budget,maPeriod:200,dipThreshold:-10,rsiThreshold:30}}
    ];
    var all=[];
    ASSETS.forEach(function(tk){strats.forEach(function(s){var r=runStrategy(tk,s.t,s.p,sd,null);if(r){r.stratLabel=s.l;all.push(r);}});});
    all.sort(function(a,b){return b.finalValue-a.finalValue;});
    setR({all:all,yr:yr,budget:budget});setBusy(false);
  },80);};

  return React.createElement('div',null,
    React.createElement(HelpBox,null,
      React.createElement('div',{className:'hitem'},React.createElement('b',null,'ì‚¬ìš©ë²•: '),'ì‹œì‘ ì‹œì ê³¼ ì›” íˆ¬ìê¸ˆì„ ì„ íƒí•œ ë’¤ ',React.createElement('span',{style:{color:'var(--g)',fontWeight:600}},'ğŸš€ ì „ì²´ ì „ëµ ê³„ì‚°'),' ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.'),
      React.createElement('div',{className:'hitem'},'15ê°œ ìì‚° Ã— 7ê°œ ì „ëµ = ',React.createElement('b',null,'105ê°œ ì¡°í•©'),'ì„ ìë™ìœ¼ë¡œ ê³„ì‚°í•˜ì—¬ ìˆ˜ìµë¥  ìˆœìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.'),
      React.createElement('div',{className:'hitem'},'ê³¼ê±° ì‹œì ë¶€í„° ë§¤ì›” ê¾¸ì¤€íˆ íˆ¬ìí–ˆë‹¤ë©´ ì˜¤ëŠ˜ ìì‚°ì´ ì–¼ë§ˆê°€ ëì„ì§€ í™•ì¸í•´ë³´ì„¸ìš”.')
    ),
    React.createElement('div',{className:'tm-hero'},
      React.createElement('h2',null,'â° íƒ€ì„ë¨¸ì‹ '),
      React.createElement('p',null,'ê³¼ê±°ì˜ í•œ ì‹œì ì„ ì„ íƒí•˜ì„¸ìš”. ëª¨ë“  ì „ëµì˜ í˜„ì¬ ê°€ì¹˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.')
    ),
    React.createElement('div',{className:'tm-ctrls'},
      React.createElement('div',{className:'tm-ctrl'},
        React.createElement('label',null,'ì‹œì‘ ì‹œì '),
        React.createElement('select',{value:evt,onChange:function(e){setE(+e.target.value);setCY('');}},LIFE_EVENTS.map(function(e,i){return React.createElement('option',{key:i,value:i},e.l);}))
      ),
      React.createElement('div',{className:'tm-ctrl'},
        React.createElement('label',null,'ì§ì ‘ ì…ë ¥ (ì—°ë„)'),
        React.createElement('input',{type:'number',min:1998,max:2025,placeholder:'ì˜ˆ: 2015',value:cYear,onChange:function(e){setCY(e.target.value);}})
      ),
      React.createElement('div',{className:'tm-ctrl'},
        React.createElement('label',null,'ì›” íˆ¬ìê¸ˆ'),
        React.createElement('select',{value:budget,onChange:function(e){setB(+e.target.value);}},[100,200,300,500,1000,2000,5000].map(function(b){return React.createElement('option',{key:b,value:b},'$'+b+'/ì›”');}))
      )
    ),
    React.createElement('button',{className:'tm-run',onClick:run},'ğŸš€ ì „ì²´ ì „ëµ ê³„ì‚°'),
    busy&&React.createElement('div',{className:'loading'},React.createElement('div',{className:'spinner'}),React.createElement('span',{style:{color:'var(--t4)',fontSize:12}},ASSETS.length*7+'ê°œ ì¡°í•© í…ŒìŠ¤íŠ¸ ì¤‘...')),
    res&&!busy&&React.createElement('div',{style:{marginTop:20}},
      React.createElement('div',{style:{textAlign:'center',color:'var(--t2)',fontSize:12,marginBottom:16}},
        React.createElement('span',{style:{color:'var(--g)',fontWeight:700}},res.yr+'ë…„'),' ë¶€í„° ',
        React.createElement('span',{style:{color:'var(--g)',fontWeight:700}},'$'+res.budget+'/ì›”'),' íˆ¬ì â€” ',res.all.length+'ê°œ ì¡°í•© í…ŒìŠ¤íŠ¸ ì™„ë£Œ'
      ),
      React.createElement('div',{className:'podium'},
        res.all.slice(0,3).map(function(r,i){
          var cls=['g','s','b'][i];
          return React.createElement('div',{key:i,className:'pod '+cls},
            React.createElement('div',{className:'rk'},['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'][i]),
            React.createElement('div',{className:'pa'},r.label),
            React.createElement('div',{className:'ps'},r.stratLabel),
            React.createElement('div',{className:'pv'},fmt(r.finalValue)),
            React.createElement('div',{className:'pr'},fPct(r.totalReturn)+' Â· ì›ê¸ˆ '+fmt(r.invested))
          );
        })
      ),
      React.createElement('div',{style:{background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:16,marginBottom:16}},
        React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'ìƒìœ„ 3ê°œ ìì‚° ê³¡ì„ '),
        React.createElement(CanvasChart,{results:res.all.slice(0,3),showBH:false})
      ),
      React.createElement('div',{style:{background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:16,maxHeight:600,overflowY:'auto'}},
        React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'ì „ì²´ ê²°ê³¼ (ìƒìœ„ 50ê°œ)'),
        React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:8}},
          res.all.slice(0,50).map(function(r,i){
            var statsRow=[
              React.createElement('div',{key:'ret',style:{textAlign:'center'}},
                React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'ìˆ˜ìµë¥ '),
                React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:14,fontWeight:700,color:r.totalReturn>0?'var(--g)':'var(--r)'}},fPct(r.totalReturn))
              ),
              React.createElement('div',{key:'final',style:{textAlign:'center'}},
                React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'ìµœì¢…'),
                React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:14,fontWeight:600,color:'var(--g)'}},fmt(r.finalValue))
              ),
              React.createElement('div',{key:'inv',style:{textAlign:'center'}},
                React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'ì›ê¸ˆ'),
                React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:13,color:'var(--t2)'}},fmt(r.invested))
              ),
              React.createElement('div',{key:'cagr',style:{textAlign:'center'}},
                React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'CAGR'),
                React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:13,color:'var(--t1)'}},fPct(r.cagr))
              ),
              React.createElement('div',{key:'mdd',style:{textAlign:'center'}},
                React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'MDD'),
                React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:13,color:'var(--r)'}},fPct(r.maxDD))
              )
            ];
            return React.createElement('div',{key:i,style:{background:'var(--bg1)',border:'1px solid var(--bdr)',borderRadius:9,padding:'12px 14px'}},
              React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6}},
                React.createElement('span',{style:{fontSize:i<3?16:12,fontWeight:800,color:i<3?'var(--y)':'var(--t4)',minWidth:24}},i<3?['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'][i]:(i+1)),
                React.createElement('span',{style:{color:COLORS[r.ticker],fontWeight:700,fontSize:12}},r.label),
                React.createElement('span',{style:{color:'var(--t3)',fontSize:11}},r.stratLabel)
              ),
              React.createElement('div',{style:{display:'flex',justifyContent:'space-around',gap:8,paddingTop:8,borderTop:'1px solid var(--bdr)'}},statsRow),
              React.createElement(StratExplain,{label:r.stratLabel})
            );
          })
        )
      )
    )
  );
}

/* ===== íƒ­ 2: ë¬´ì§€ì„± í¬íŠ¸í´ë¦¬ì˜¤ ===== */
function BestPortfolios(){
  var s1=useState(10),period=s1[0],setP=s1[1];
  var s2=useState(null),res=s2[0],setR=s2[1];
  var s3=useState(false),busy=s3[0],setBusy=s3[1];
  var PC=['#00ff88','#4488ff','#ffcc00','#ff8844','#f7931a','#627eea','#ffd700','#00ccee','#aa66ff','#ff4466','#44cc44','#ff66aa','#cc44ff','#c0c0c0','#8b6914'];
  var PF_COLORS=['#00ff88','#4488ff','#ffcc00'];

  var run=function(){setBusy(true);setTimeout(function(){
    var sd=getStart(period);
    var ar={};ASSETS.forEach(function(t){var r=runStrategy(t,'dca',{budget:500,frequency:'monthly'},sd,null);if(r)ar[t]=r;});
    var av=Object.keys(ar);if(!av.length){setR(null);setBusy(false);return;}
    var byR=av.slice().sort(function(a,b){return ar[b].totalReturn-ar[a].totalReturn;});
    var byDD=av.slice().sort(function(a,b){return ar[b].maxDD-ar[a].maxDD;});
    var byS=av.slice().sort(function(a,b){var sa=ar[a].maxDD!==0?ar[a].cagr/Math.abs(ar[a].maxDD):0;var sb=ar[b].maxDD!==0?ar[b].cagr/Math.abs(ar[b].maxDD):0;return sb-sa;});

    var build=function(ranked,name,desc,pfColor){
      var top=ranked.slice(0,5),ws=[20,20,20,20,20];
      var allocs=top.map(function(t,i){var o=Object.assign({},ar[t]);o.w=ws[i];o.color=PC[ASSETS.indexOf(t)];return o;});
      var wr=allocs.reduce(function(s,a){return s+a.totalReturn*a.w/100;},0);
      var wc=allocs.reduce(function(s,a){return s+a.cagr*a.w/100;},0);
      var minLen=Infinity;
      allocs.forEach(function(a){if(a.curve&&a.curve.length<minLen)minLen=a.curve.length;});
      var pfCurve=[],pfDates=[];
      if(minLen>0&&minLen<Infinity){
        for(var i=0;i<minLen;i++){
          var wVal=0;
          allocs.forEach(function(a){if(a.curve&&a.curve[i])wVal+=a.curve[i].value*(a.w/100);});
          pfCurve.push(Math.round(wVal*100)/100);
          if(allocs[0].curve[i])pfDates.push(allocs[0].curve[i].date);
        }
      }
      return{name:name,desc:desc,allocs:allocs,wr:wr,wc:wc,pfCurve:pfCurve,pfDates:pfDates,pfColor:pfColor};
    };

    setR({
      maxR:build(byR,'ğŸš€ ìµœëŒ€ ìˆ˜ìµ','ì´ ìˆ˜ìµë¥  ìµœëŒ€í™” ê¸°ì¤€',PF_COLORS[0]),
      bestS:build(byS,'âš–ï¸ ìµœê³  ìœ„í—˜ ëŒ€ë¹„ ìˆ˜ìµ','ë‚™í­ ëŒ€ë¹„ ìˆ˜ìµë¥  ìµœì í™”',PF_COLORS[1]),
      lowDD:build(byDD,'ğŸ›¡ï¸ ìµœì†Œ ë‚™í­','í¬íŠ¸í´ë¦¬ì˜¤ í•˜ë½ ìµœì†Œí™”',PF_COLORS[2]),
      ind:av.map(function(t){return ar[t];}).sort(function(a,b){return b.totalReturn-a.totalReturn;})
    });
    setBusy(false);
  },80);};

  useEffect(run,[period]);

  return React.createElement('div',null,
    React.createElement(HelpBox,null,
      React.createElement('div',{className:'hitem'},React.createElement('b',null,'ì‚¬ìš©ë²•: '),'ê¸°ê°„ì„ ì„ íƒí•˜ë©´ ë§¤ë‹¬ $500 ë¬´ì§€ì„± ì ë¦½ì‹ ê¸°ì¤€ìœ¼ë¡œ ìµœì  í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ìë™ ê³„ì‚°í•©ë‹ˆë‹¤.'),
      React.createElement('div',{className:'hitem'},'ì „ëµ? íƒ€ì´ë°? ê·¸ëŸ° ê±° ì—†ìŠµë‹ˆë‹¤. ë§¤ë‹¬ ê°™ì€ ê¸ˆì•¡ì„ ë„£ê¸°ë§Œ í–ˆì„ ë•Œ ì–´ë–¤ ìì‚° ì¡°í•©ì´ ìµœê³ ì˜€ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.'),
      React.createElement('div',{className:'hitem'},React.createElement('span',{className:'tag'},'ìµœëŒ€ ìˆ˜ìµ'),' ì´ ìˆ˜ìµë¥ ì´ ê°€ì¥ ë†’ì€ ìì‚° ì¡°í•©'),
      React.createElement('div',{className:'hitem'},React.createElement('span',{className:'tag'},'ìœ„í—˜ ëŒ€ë¹„ ìˆ˜ìµ'),' ë‚™í­ ëŒ€ë¹„ ìˆ˜ìµë¥ ì´ ê°€ì¥ ì¢‹ì€ ìì‚° ì¡°í•© (ë¦¬ìŠ¤í¬ íš¨ìœ¨)'),
      React.createElement('div',{className:'hitem'},React.createElement('span',{className:'tag'},'ìµœì†Œ ë‚™í­'),' í•˜ë½ì¥ì—ì„œ ê°€ì¥ ì ê²Œ ë–¨ì–´ì§€ëŠ” ì•ˆì •ì ì¸ ìì‚° ì¡°í•©'),
      React.createElement('div',{className:'hitem',style:{marginTop:6}},'ìƒìœ„ 5ê°œ ìì‚°ì— ê° 20%ì”© ê· ë“± ë°°ë¶„í•©ë‹ˆë‹¤.')
    ),
    React.createElement('div',{style:{textAlign:'center',padding:'28px 0 18px'}},
      React.createElement('h2',{style:{fontSize:26,fontWeight:800,marginBottom:8}},'ğŸ¤· ë¬´ì§€ì„± ì ë¦½ì‹ ìµœê°• ì¡°í•©'),
      React.createElement('p',{style:{fontSize:14,marginBottom:16,lineHeight:1.7}},
        'ë§¤ë‹¬ ',React.createElement('span',{style:{color:'#00ff88',fontWeight:800,fontSize:16}},'$500'),', ì•„ë¬´ ìƒê° ì—†ì´ ',React.createElement('span',{style:{color:'#ffcc00',fontWeight:700}},'ê¾¸ì¤€íˆ ë„£ê¸°ë§Œ'),' í–ˆë‹¤ë©´',React.createElement('br',null),'ì–´ë–¤ ìì‚°ì´ ',React.createElement('span',{style:{color:'#4488ff',fontWeight:700}},'ìµœê³ '),'ì˜€ì„ê¹Œ?'
      ),
      React.createElement('div',{className:'prow',style:{justifyContent:'center'}},[25,20,15,10,5,3,1].map(function(y){return React.createElement('div',{key:y,className:'pbtn'+(period===y?' on':''),onClick:function(){setP(y);}},y+'ë…„');}))
    ),
    busy?React.createElement('div',{className:'loading'},React.createElement('div',{className:'spinner'})):
    res&&React.createElement(React.Fragment,null,
      React.createElement('div',{className:'pfgrid'},
        [res.maxR,res.bestS,res.lowDD].map(function(p,pi){
          return React.createElement('div',{key:pi,className:'pfcard'},
            React.createElement('h3',null,p.name),
            React.createElement('div',{className:'dd'},p.desc),
            React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:18,fontWeight:700,color:'var(--g)',marginBottom:3}},fPct(p.wr)+' ìˆ˜ìµ'),
            React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:11,color:'var(--t2)',marginBottom:10}},'CAGR: '+fPct(p.wc)),
            React.createElement(Sparkline,{data:p.pfCurve,color:p.pfColor,height:100}),
            React.createElement('div',{className:'abar'},p.allocs.map(function(a,i){return React.createElement('div',{key:i,style:{width:a.w+'%',background:a.color},title:a.label+': '+a.w+'%'});})),
            React.createElement('div',{className:'alist'},p.allocs.map(function(a,i){
              return React.createElement('div',{key:i,className:'aitm'},
                React.createElement('span',null,React.createElement('span',{className:'dot',style:{background:a.color}}),a.label),
                React.createElement('span',{style:{fontFamily:'JetBrains Mono',fontWeight:600}},a.w+'% Â· '+fPct(a.totalReturn))
              );
            }))
          );
        })
      ),
      React.createElement('div',{style:{marginTop:20,background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:20}},
        React.createElement('div',{style:{fontSize:14,fontWeight:700,marginBottom:4}},'í¬íŠ¸í´ë¦¬ì˜¤ ì„±ê³¼ ë¹„êµ'),
        React.createElement('div',{style:{fontSize:11,color:'var(--t2)',marginBottom:14}},period+'ë…„ê°„ $500/ì›” ì ë¦½ ì‹œ í¬íŠ¸í´ë¦¬ì˜¤ ìì‚° ë³€í™”'),
        React.createElement('div',{style:{display:'flex',gap:16,marginBottom:10,flexWrap:'wrap'}},
          [res.maxR,res.bestS,res.lowDD].map(function(p,i){
            return React.createElement('div',{key:i,style:{display:'flex',alignItems:'center',gap:5,fontSize:11}},
              React.createElement('div',{style:{width:12,height:3,borderRadius:2,background:p.pfColor}}),
              React.createElement('span',{style:{color:p.pfColor,fontWeight:600}},p.name.replace(/[^\w\sã„±-í£]/g,'').trim())
            );
          })
        ),
        React.createElement(ComparisonChart,{portfolios:[res.maxR,res.bestS,res.lowDD],height:340})
      ),
      React.createElement('div',{style:{marginTop:20,background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:16}},
        React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'ê°œë³„ ìì‚° ìˆœìœ„ ('+period+'ë…„ ì ë¦½ì‹)'),
        React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:8}},
          res.ind.map(function(r,i){
            return React.createElement('div',{key:r.ticker,style:{background:'var(--bg1)',border:'1px solid var(--bdr)',borderRadius:9,padding:'12px 14px'}},
              React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6}},
                React.createElement('span',{style:{fontSize:i<3?16:12,fontWeight:800,color:i<3?'var(--y)':'var(--t4)',minWidth:24}},i<3?['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'][i]:(i+1)),
                React.createElement('span',{style:{color:COLORS[r.ticker],fontWeight:700,fontSize:12}},r.label)
              ),
              React.createElement('div',{style:{display:'flex',justifyContent:'space-around',gap:8,paddingTop:8,borderTop:'1px solid var(--bdr)'}},
                React.createElement('div',{style:{textAlign:'center'}},
                  React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'ìˆ˜ìµë¥ '),
                  React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:14,fontWeight:700,color:r.totalReturn>0?'var(--g)':'var(--r)'}},fPct(r.totalReturn))
                ),
                React.createElement('div',{style:{textAlign:'center'}},
                  React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'ìµœì¢…'),
                  React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:14,fontWeight:600,color:'var(--g)'}},fmt(r.finalValue))
                ),
                React.createElement('div',{style:{textAlign:'center'}},
                  React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'ì›ê¸ˆ'),
                  React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:13,color:'var(--t2)'}},fmt(r.invested))
                ),
                React.createElement('div',{style:{textAlign:'center'}},
                  React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'CAGR'),
                  React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:13,color:'var(--t1)'}},fPct(r.cagr))
                ),
                React.createElement('div',{style:{textAlign:'center'}},
                  React.createElement('div',{style:{fontSize:8,color:'var(--t4)'}},'MDD'),
                  React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:13,color:'var(--r)'}},fPct(r.maxDD))
                )
              )
            );
          })
        )
      )
    )
  );
}

/* ===== ê³µìœ  ë°” ===== */
function ShareBar(){
  var svgX='<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>';
  var svgKakao='<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3C6.477 3 2 6.463 2 10.691c0 2.724 1.8 5.112 4.508 6.458l-1.148 4.265a.5.5 0 0 0 .764.533l4.94-3.26c.304.02.612.03.936.03 5.523 0 10-3.462 10-7.735C22 6.463 17.523 3 12 3z"/></svg>';
  var svgTg='<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.479.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>';
  var svgIg='<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>';
  var svgLink='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>';

  function btn(cls,platform,icon,label){
    return React.createElement('button',{className:'share-btn '+cls,onClick:function(e){doShare(platform,e.currentTarget);},dangerouslySetInnerHTML:{__html:icon+'<span class="lbl">'+label+'</span>'}});
  }
  return React.createElement('div',{className:'share-bar'},
    React.createElement('div',{className:'share-bar-preview'},React.createElement('b',null,'íƒ€ì„ë¨¸ì‹  & í¬íŠ¸í´ë¦¬ì˜¤'),' â€” herdvibe.com'),
    React.createElement('div',{className:'share-bar-buttons'},
      btn('share-btn--x','twitter',svgX,'íŠ¸ìœ„í„°'),
      btn('share-btn--kakao','kakao',svgKakao,'ì¹´ì¹´ì˜¤í†¡'),
      btn('share-btn--tg','telegram',svgTg,'í…”ë ˆê·¸ë¨'),
      btn('share-btn--ig','instagram',svgIg,'ì¸ìŠ¤íƒ€'),
      btn('share-btn--copy','link',svgLink,'ë§í¬ ë³µì‚¬')
    )
  );
}

/* ===== ì•± ===== */
function App(){
  var s1=useState(0),tab=s1[0],setTab=s1[1];
  return React.createElement('div',null,
    React.createElement('div',{className:'hdr'},
      React.createElement('a',{className:'nav-link',href:'strategy1.html'},'â† ì‹œë®¬ë ˆì´í„°'),
      React.createElement('span',{className:'hdr-title'},'ì „ëµ ì—°êµ¬'),
      React.createElement('div',{className:'tabs'},
        ['â° íƒ€ì„ë¨¸ì‹ ','ğŸ¤· ë¬´ì§€ì„± í¬íŠ¸í´ë¦¬ì˜¤'].map(function(t,i){
          return React.createElement('button',{key:i,className:'tab'+(tab===i?' on':''),onClick:function(){setTab(i);}},t);
        })
      )
    ),
    React.createElement('div',{className:'main'},
      tab===0&&React.createElement(TimeMachine,null),
      tab===1&&React.createElement(BestPortfolios,null)
    ),
    React.createElement(ShareBar,null)
  );
}

ReactDOM.render(React.createElement(App,null),document.getElementById('root'));
</script>
<script>
(function(){
  var lastH=0;
  setInterval(function(){
    if(window.parent!==window){
      var h=document.body.scrollHeight;
      if(h!==lastH){lastH=h;window.parent.postMessage({type:'resize',height:h},'*');}
    }
  },300);
})();
</script>
</body>
</html>
